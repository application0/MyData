<!DOCTYPE html>
<html lang="en">
<head>
  <script type='text/javascript' src='//pl27022518.profitableratecpm.com/c9/4a/0b/c94a0b4ed40971010199e9dd59a95e25.js'></script>
  <script type='text/javascript' src='//pl27022539.profitableratecpm.com/99/05/75/9905753e8d9eea31d7017cc9d3c18caa.js'></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Porn Video Player Pro - Universal Video Support with Advanced Search & Caching</title>
  <meta name="description" content="Advanced porn video player with search, thumbnails, smart caching, TikTok-style fullscreen, and universal video support. Fast loading with background preloading.">
  <meta name="keywords" content="video player, search videos, thumbnails, smart caching, TikTok style, universal support, fast loading, porn, xxnx, xxx, xvideos">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    body {
      font-family: 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #222;
      overflow-x: hidden;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    video {
      pointer-events: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    video::-webkit-media-controls-download-button {
      display: none;
    }

    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.3;
    }

    .particle {
      position: absolute;
      background: rgba(255,255,255,0.7);
      border-radius: 50%;
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }

    header {
      text-align: center;
      padding: 2rem 1rem 1.5rem 1rem;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-bottom-left-radius: 2.5rem;
      border-bottom-right-radius: 2.5rem;
      box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
      animation: slideDown 1.2s ease;
      margin-bottom: 1rem;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientShift 3s ease infinite;
      margin-bottom: 0.8rem;
    }

    .subtitle {
      font-size: 1.1rem;
      color: rgba(255,255,255,0.9);
      font-weight: 400;
      margin-top: 0.5rem;
    }

    .highlight {
      color: #ff6b6b;
      font-weight: 600;
    }

    /* Enhanced Loading with Ads and Progress */
    .loading-container {
      position: relative;
      text-align: center;
      padding: 2rem;
      background: rgba(255,255,255,0.1);
      border-radius: 2rem;
      margin: 1rem;
      backdrop-filter: blur(10px);
    }

    .loading-ads {
      margin: 1rem 0;
      padding: 1rem;
      background: rgba(255,255,255,0.05);
      border-radius: 1rem;
      border: 1px solid rgba(255,255,255,0.1);
    }

    /* Enhanced Thumbnail Styles */
    .video-thumbnail {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 1.8rem;
      opacity: 0.9;
      transition: all 0.3s ease;
      z-index: 1;
    }

    .video-thumbnail-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(0,0,0,0.3), rgba(0,0,0,0.6));
      border-radius: 1.8rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2;
      transition: all 0.3s ease;
    }

    .video-thumbnail-overlay:hover {
      background: linear-gradient(135deg, rgba(0,0,0,0.1), rgba(0,0,0,0.4));
    }

    .play-button {
      width: 80px;
      height: 80px;
      background: rgba(255,255,255,0.95);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: #333;
      animation: pulse 2s ease-in-out infinite;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }

    .play-button:hover {
      transform: scale(1.1);
      background: rgba(255,255,255,1);
    }

    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .video-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(15px);
      border-radius: 2rem;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    .video-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      border-color: rgba(255,255,255,0.3);
    }

    .video-card-header {
      padding: 1rem;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .video-card-title {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.9);
      margin: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .video-card-domain {
      font-size: 0.7rem;
      color: rgba(255,255,255,0.6);
      margin-top: 0.2rem;
    }

    /* Fullscreen TikTok Style */
    .fullscreen-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      z-index: 10000;
      display: none;
      overflow: hidden;
    }

    .fullscreen-video {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .fullscreen-controls {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      z-index: 10001;
    }

    .fullscreen-btn {
      width: 50px;
      height: 50px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .fullscreen-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: scale(1.1);
    }

    .swipe-indicator {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255,255,255,0.6);
      font-size: 0.8rem;
      writing-mode: vertical-lr;
      text-orientation: mixed;
      pointer-events: none;
    }

    /* Fullscreen Ad Overlay */
    .fullscreen-ad {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      border-radius: 1rem;
      padding: 1rem;
      z-index: 10002;
    }

    /* Enhanced Product Cards */
    .product-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(15px);
      border-radius: 2rem;
      padding: 1.5rem;
      margin: 1rem;
      border: 1px solid rgba(255,255,255,0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      border-color: rgba(255,255,255,0.3);
    }

    .product-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 1rem;
      margin-bottom: 1rem;
      transition: transform 0.3s ease;
    }

    .product-card:hover .product-image {
      transform: scale(1.05);
    }

    .product-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: white;
      margin-bottom: 0.8rem;
      line-height: 1.4;
    }

    .product-text {
      color: rgba(255,255,255,0.8);
      margin-bottom: 1.2rem;
      line-height: 1.5;
    }

    .product-button {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      width: 100%;
      text-align: center;
      box-shadow: 0 4px 15px rgba(255,107,107,0.3);
    }

    .product-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255,107,107,0.4);
    }

    .product-badge {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #ff6b6b;
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 2rem;
      font-size: 0.8rem;
      font-weight: 600;
      animation: pulse 2s ease-in-out infinite;
    }

    /* Product Pagination */
    .product-pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }

    .product-page-btn {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
      padding: 0.8rem 1.5rem;
      border-radius: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .product-page-btn:hover {
      background: rgba(255,255,255,0.2);
      transform: translateY(-2px);
    }

    .product-page-btn.active {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-color: transparent;
    }

    /* Ad Containers */
    .ad-container {
      text-align: center;
      margin: 1rem auto;
      padding: 1rem;
      background: rgba(255,255,255,0.1);
      border-radius: 1rem;
      backdrop-filter: blur(10px);
    }

    .ad-top {
      max-width: 728px;
      margin: 1rem auto;
    }

    .ad-sidebar {
      position: fixed;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 1000;
    }

    .ad-mobile {
      display: none;
    }

    @media (max-width: 768px) {
      .ad-sidebar { display: none; }
      .ad-mobile { display: block; }
      .ad-top { max-width: 320px; }
      h1 { font-size: 2rem; }
      header { padding: 1.5rem 1rem 1rem 1rem; }
      .video-grid { grid-template-columns: 1fr; }
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes slideDown {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }

    .loading {
      text-align: center;
      padding: 2rem;
      font-size: 1.2rem;
      color: rgba(255,255,255,0.8);
    }

    .spinner {
      border: 4px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top: 4px solid #ff6b6b;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 1rem auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .status {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 1rem;
      padding: 1rem 2rem;
      margin: 1rem auto;
      max-width: 500px;
      text-align: center;
      color: rgba(255,255,255,0.9);
    }

    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin: 2rem auto;
      flex-wrap: wrap;
    }

    .pagination button {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 1rem;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .pagination button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .pagination .current-page {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      font-size: 1.1rem;
      padding: 0.8rem 2rem;
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .video-container {
      width: 100%;
      max-width: 800px;
      margin: 2rem auto;
      perspective: 1500px;
      transition: transform 0.3s ease;
    }

    .video-container:hover {
      transform: translateY(-10px) scale(1.02);
    }

    .video-inner {
      position: relative;
      width: 100%;
      padding-top: 56.25%;
      transform-style: preserve-3d;
      transition: transform 1.2s cubic-bezier(0.4,0.2,0.2,1);
      border-radius: 2rem;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      cursor: pointer;
    }

    .video-container:hover .video-inner {
      transform: rotateY(180deg);
    }

    .video-face {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 2rem;
      overflow: hidden;
      backface-visibility: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(10px);
    }

    .video-front {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      font-weight: 600;
      font-size: 1.4rem;
      letter-spacing: 0.05em;
      text-align: center;
      padding: 2rem;
      position: relative;
    }

    .video-icon {
      font-size: 3.5rem;
      margin-bottom: 1rem;
      animation: pulse 2s ease-in-out infinite;
      display: block;
    }

    .video-back {
      background: #1a1a2e;
      color: #fff;
      transform: rotateY(180deg);
      padding: 0;
    }

    video, iframe {
      width: 100%;
      height: 100%;
      border-radius: 1.8rem;
      object-fit: cover;
      background: #000;
      border: none;
      pointer-events: auto;
    }

    .error-card {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      padding: 2rem;
      text-align: center;
      border-radius: 2rem;
      font-size: 1.1rem;
      box-shadow: 0 10px 25px rgba(255,107,107,0.3);
      margin: 1rem;
    }

    .success-card {
      background: linear-gradient(135deg, #4ecdc4, #44a08d);
      color: white;
      padding: 1rem;
      text-align: center;
      border-radius: 1rem;
      font-size: 0.9rem;
      margin: 0.5rem;
    }

    .warning-card {
      background: linear-gradient(135deg, #f7971e, #ffd200);
      color: #333;
      padding: 1rem;
      text-align: center;
      border-radius: 1rem;
      font-size: 0.9rem;
      margin: 0.5rem;
    }

    footer {
      margin: 3rem 0 2rem 0;
      text-align: center;
      color: rgba(255,255,255,0.7);
      font-size: 1rem;
      background: rgba(255,255,255,0.1);
      padding: 2rem;
      backdrop-filter: blur(10px);
      border-radius: 2rem 2rem 0 0;
    }

    .direct-link-ad {
      text-align: center;
      margin: 2rem auto;
      padding: 1rem;
    }

    .direct-link-ad a {
      display: inline-block;
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      text-decoration: none;
      padding: 1rem 2rem;
      border-radius: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .direct-link-ad a:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>
  
  <header>
    <h1>🔥 Smart Video Player Pro</h1>
    <p class="subtitle">Universal Video Support with Advanced Features<br>
    <span class="highlight">Search • Thumbnails • Smart Caching • TikTok Fullscreen</span></p>
    
    <!-- Advanced Search Bar -->
    <div style="margin-top: 1.5rem; max-width: 600px; margin-left: auto; margin-right: auto;">
      <div style="position: relative;">
        <input type="text" id="searchInput" placeholder="🔍 Search videos by URL, domain, or keywords..." 
               style="width: 100%; padding: 1rem 3rem 1rem 1rem; font-size: 16px; border: none; border-radius: 1rem; 
                      background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); color: white; 
                      border: 1px solid rgba(255,255,255,0.2);"
               onkeyup="handleSearch(event)">
        <button onclick="performSearch()" 
                style="position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); 
                       background: linear-gradient(135deg, #ff6b6b, #ee5a24); border: none; 
                       color: white; padding: 0.7rem 1rem; border-radius: 0.7rem; cursor: pointer;">
          Search
        </button>
      </div>
      <div id="searchSuggestions" style="display: none; margin-top: 0.5rem; background: rgba(255,255,255,0.1); 
                                         backdrop-filter: blur(10px); border-radius: 1rem; max-height: 200px; overflow-y: auto;"></div>
    </div>
  </header>

  <!-- Top Banner Ad -->
  <div class="ad-container ad-top">
    <script type="text/javascript">
      atOptions = {
        'key' : 'c4810f25a920955af5c914a3779d9d61',
        'format' : 'iframe',
        'height' : 90,
        'width' : 728,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/c4810f25a920955af5c914a3779d9d61/invoke.js"></script>
  </div>

  <!-- Mobile Banner Ad -->
  <div class="ad-container ad-mobile">
    <script type="text/javascript">
      atOptions = {
        'key' : '36f4b2bf5008f70474c95ef23c47b4d0',
        'format' : 'iframe',
        'height' : 50,
        'width' : 320,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/36f4b2bf5008f70474c95ef23c47b4d0/invoke.js"></script>
  </div>

  <!-- Sidebar Ad -->
  <div class="ad-sidebar">
    <script type="text/javascript">
      atOptions = {
        'key' : '1fbbabca3c454cbef505889b7fdf86bc',
        'format' : 'iframe',
        'height' : 600,
        'width' : 160,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/1fbbabca3c454cbef505889b7fdf86bc/invoke.js"></script>
  </div>

  <!-- Enhanced Loading with Ads and Progress -->
  <div class="loading-container" id="loading">
    <div class="spinner"></div>
    <div style="font-size: 1.2rem; color: rgba(255,255,255,0.8); margin: 1rem 0;">
      <span id="loadingText">Loading Video... please wait...</span>
    </div>
    <div class="status" id="status">Status: Loading URL list...</div>
    
    <!-- Advanced Progress Bar -->
    <div style="width: 100%; background: rgba(255,255,255,0.1); border-radius: 1rem; margin: 1rem 0; overflow: hidden;">
      <div id="progressBar" style="width: 0%; height: 8px; background: linear-gradient(135deg, #ff6b6b, #4ecdc4); 
                                   border-radius: 1rem; transition: width 0.3s ease;"></div>
    </div>
    <div id="progressText" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); text-align: center;">0% Complete</div>
    
    <!-- Loading Ads -->
    <div class="loading-ads">
      <script type="text/javascript">
        atOptions = {
          'key' : '04d176f478f7739bcbcd4263486f4bb2',
          'format' : 'iframe',
          'height' : 250,
          'width' : 300,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/04d176f478f7739bcbcd4263486f4bb2/invoke.js"></script>
    </div>
    
    <!-- Background Loading Status -->
    <div id="backgroundStatus" style="display: none; margin-top: 1rem; padding: 1rem; 
                                      background: rgba(0,255,0,0.1); border-radius: 1rem; border: 1px solid rgba(0,255,0,0.2);">
      <div style="font-size: 0.9rem; color: rgba(255,255,255,0.8);">
        📚 Background Loading: <span id="backgroundProgress">0</span>/<span id="totalVideos">0</span> videos cached
      </div>
    </div>
    
    <div style="color: rgba(255,255,255,0.6); font-size: 0.9rem; margin-top: 1rem;">
      💡 Tip: Videos load faster on subsequent visits due to smart caching
    </div>
  </div>

  <!-- Native Banner Ad -->
  <div class="ad-container">
    <script async="async" data-cfasync="false" src="//pl27022671.profitableratecpm.com/bd33afff2b0d2055fa33924d85770ab4/invoke.js"></script>
    <div id="container-bd33afff2b0d2055fa33924d85770ab4"></div>
  </div>

  <main id="videos" style="display: none;">
    <!-- Videos will be inserted here -->
  </main>

  <!-- Fullscreen TikTok-style Container -->
  <div class="fullscreen-container" id="fullscreenContainer">
    <div class="fullscreen-controls">
      <button class="fullscreen-btn" onclick="exitFullscreen()" title="Exit Fullscreen">✕</button>
      <button class="fullscreen-btn" onclick="previousVideo()" title="Previous Video">↑</button>
      <button class="fullscreen-btn" onclick="nextVideo()" title="Next Video">↓</button>
      <button class="fullscreen-btn" onclick="randomVideo()" title="Random Video">🎲</button>
    </div>
    <div class="swipe-indicator">Swipe ↕ for videos</div>
    <div id="fullscreenContent"></div>
    
    <!-- Fullscreen Ad -->
    <div class="fullscreen-ad">
      <script type="text/javascript">
        atOptions = {
          'key' : '84fb95635357c8ec40e2f84914bc10a5',
          'format' : 'iframe',
          'height' : 60,
          'width' : 320,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/84fb95635357c8ec40e2f84914bc10a5/invoke.js"></script>
    </div>
  </div>

  <div class="pagination" id="pagination" style="display: none;">
    <!-- Pagination controls will be inserted here -->
  </div>

  <!-- Square Banner Ad -->
  <div class="ad-container">
    <script type="text/javascript">
      atOptions = {
        'key' : '84fb95635357c8ec40e2f84914bc10a5',
        'format' : 'iframe',
        'height' : 60,
        'width' : 468,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/84fb95635357c8ec40e2f84914bc10a5/invoke.js"></script>
  </div>

  <!-- Enhanced Products Section -->
  <section style="padding: 3rem 1rem; background: rgba(255,255,255,0.05); margin: 2rem 0; border-radius: 2rem;">
    <div style="max-width: 1200px; margin: 0 auto;">
      <div style="text-align: center; margin-bottom: 3rem;">
        <h3 style="font-size: 2.5rem; font-weight: 700; color: white; margin-bottom: 1rem;">
          🛍️ Featured Products & Tools
        </h3>
        <p style="font-size: 1.1rem; color: rgba(255,255,255,0.7);">
          Handpicked selection of premium products and innovative solutions
        </p>
      </div>
      
      <div id="products-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
        <!-- Products will be loaded here -->
      </div>
      
      <!-- Product Pagination -->
      <div class="product-pagination" id="productPagination" style="display: none;">
        <!-- Product pagination will be inserted here -->
      </div>
    </div>
  </section>

  <!-- Direct Link Ad -->
  <div class="direct-link-ad">
    <a href="https://www.profitableratecpm.com/xhjfmx5aty?key=52605e1088aa60e296bd2cb234e5d209" target="_blank">
      🎬 Premium Video Collection - Click Here!
    </a>
  </div>

  <!-- Vertical Banner Ad -->
  <div class="ad-container">
    <script type="text/javascript">
      atOptions = {
        'key' : '059de56bbc7afe3d490a9d7c9c68c0f9',
        'format' : 'iframe',
        'height' : 300,
        'width' : 160,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformateformat.com/059de56bbc7afe3d490a9d7c9c68c0f9/invoke.js"></script>
  </div>

  <footer>
    &copy; 2025 Smart Video Player Pro. Advanced Technology.<br>
    <small>Universal video support • Real-time extraction • Smart Caching • Search & Thumbnails</small>
  </footer>

  <script>
    // Enhanced global variables with advanced caching
    let allUrls = [];
    let filteredUrls = [];
    let currentPage = 0;
    let videosPerPage = 1; // Dynamic: 1 for first page, 5-7 for others
    let videoCache = new Map(); // Cache for processed videos
    let thumbnailCache = new Map(); // Cache for thumbnails
    let metadataCache = new Map(); // Cache for video metadata
    let isLoading = false;
    let isBackgroundLoading = false;
    let preloadedPages = new Set();
    let loadedPages = new Set();
    let productsData = [];
    let currentProductPage = 0;
    const productsPerPage = 6;
    let searchTerm = '';
    let backgroundLoadProgress = 0;

    // Disable right-click and key combinations
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', function(e) {
      if (e.keyCode == 123 || 
          (e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74)) ||
          (e.ctrlKey && e.keyCode == 85) ||
          (e.ctrlKey && e.keyCode == 83)) {
        e.preventDefault();
        return false;
      }
    });

    // Disable text selection
    document.onselectstart = function() { return false; };
    document.onmousedown = function() { return false; };

    // Create floating particles
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.width = particle.style.height = Math.random() * 4 + 2 + 'px';
        particle.style.animationDelay = Math.random() * 6 + 's';
        particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
        particlesContainer.appendChild(particle);
      }
    }

    function updateStatus(message) {
      document.getElementById('status').textContent = message;
    }

    function updateProgress(percent, text = null) {
      const progressBar = document.getElementById('progressBar');
      const progressText = document.getElementById('progressText');
      
      if (progressBar) {
        progressBar.style.width = percent + '%';
      }
      
      if (progressText) {
        progressText.textContent = text || `${Math.round(percent)}% Complete`;
      }
    }

    // Advanced Search Functions
    function handleSearch(event) {
      if (event.key === 'Enter') {
        performSearch();
      } else {
        debounceSearch();
      }
    }

    let searchTimeout;
    function debounceSearch() {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        showSearchSuggestions();
      }, 300);
    }

    function showSearchSuggestions() {
      const input = document.getElementById('searchInput');
      const suggestions = document.getElementById('searchSuggestions');
      const query = input.value.toLowerCase().trim();
      
      if (query.length < 2) {
        suggestions.style.display = 'none';
        return;
      }

      const matches = allUrls.filter(url => 
        url.toLowerCase().includes(query) || 
        new URL(url).hostname.toLowerCase().includes(query)
      ).slice(0, 5);

      if (matches.length > 0) {
        suggestions.innerHTML = matches.map(url => {
          const domain = new URL(url).hostname;
          return `
            <div onclick="selectSuggestion('${url}')" 
                 style="padding: 0.7rem 1rem; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.1);
                        transition: background 0.2s ease;"
                 onmouseover="this.style.background='rgba(255,255,255,0.1)'"
                 onmouseout="this.style.background='transparent'">
              <div style="font-size: 0.9rem; color: white;">${domain}</div>
              <div style="font-size: 0.7rem; color: rgba(255,255,255,0.6); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                ${url}
              </div>
            </div>
          `;
        }).join('');
        suggestions.style.display = 'block';
      } else {
        suggestions.style.display = 'none';
      }
    }

    function selectSuggestion(url) {
      const suggestions = document.getElementById('searchSuggestions');
      suggestions.style.display = 'none';
      
      const index = allUrls.indexOf(url);
      if (index !== -1) {
        changePage(Math.floor(index / getVideosPerPage(Math.floor(index / getVideosPerPage(0)))));
      }
    }

    function performSearch() {
      const input = document.getElementById('searchInput');
      const suggestions = document.getElementById('searchSuggestions');
      searchTerm = input.value.toLowerCase().trim();
      
      suggestions.style.display = 'none';
      
      if (searchTerm === '') {
        filteredUrls = [...allUrls];
      } else {
        filteredUrls = allUrls.filter(url => 
          url.toLowerCase().includes(searchTerm) || 
          new URL(url).hostname.toLowerCase().includes(searchTerm)
        );
      }
      
      currentPage = 0;
      loadCurrentPageVideo();
      createPagination();
      
      if (filteredUrls.length === 0) {
        document.getElementById('videos').innerHTML = `
          <div class="error-card">
            🔍 No videos found for "${searchTerm}"<br>
            <small>Try different keywords or clear the search</small>
          </div>
        `;
        document.getElementById('videos').style.display = 'block';
        document.getElementById('loading').style.display = 'none';
      }
    }

    // Enhanced pagination with dynamic page sizes
    function getVideosPerPage(pageIndex) {
      return pageIndex === 0 ? 1 : Math.floor(Math.random() * 3) + 5; // 1 for first page, 5-7 for others
    }

    function getPageBoundaries() {
      const urls = filteredUrls.length > 0 ? filteredUrls : allUrls;
      let pages = [];
      let currentIndex = 0;
      let pageIndex = 0;
      
      while (currentIndex < urls.length) {
        const videosOnThisPage = getVideosPerPage(pageIndex);
        const startIndex = currentIndex;
        const endIndex = Math.min(currentIndex + videosOnThisPage, urls.length);
        
        pages.push({ start: startIndex, end: endIndex, count: endIndex - startIndex });
        currentIndex = endIndex;
        pageIndex++;
      }
      
      return pages;
    }

    function createPagination() {
      const paginationEl = document.getElementById('pagination');
      const pages = getPageBoundaries();
      const totalPages = pages.length;
      const urls = filteredUrls.length > 0 ? filteredUrls : allUrls;
      
      if (currentPage >= totalPages) currentPage = 0;
      
      const currentPageInfo = pages[currentPage] || { count: 0 };
      
      paginationEl.innerHTML = `
        <button onclick="changePage(${Math.max(0, currentPage - 1)})" ${currentPage === 0 ? 'disabled' : ''}>
          ← Previous
        </button>
        <button class="current-page">
          Page ${currentPage + 1} of ${totalPages}
          <br><small>${currentPageInfo.count} video${currentPageInfo.count !== 1 ? 's' : ''}</small>
        </button>
        <button onclick="changePage(${Math.min(totalPages - 1, currentPage + 1)})" ${currentPage === totalPages - 1 ? 'disabled' : ''}>
          Next →
        </button>
        <button onclick="changePage(${Math.floor(Math.random() * totalPages)})">
          🎲 Random
        </button>
        <button onclick="enterFullscreen()">
          🎬 Fullscreen
        </button>
        ${searchTerm ? `<button onclick="clearSearch()" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
          ❌ Clear Search
        </button>` : ''}
        <button onclick="startBackgroundCaching()" ${isBackgroundLoading ? 'disabled' : ''}>
          📚 ${isBackgroundLoading ? 'Caching...' : 'Cache All'}
        </button>
      `;
      
      paginationEl.style.display = 'flex';
      
      // Update background status if visible
      if (isBackgroundLoading) {
        updateBackgroundStatus();
      }
      
      // Preload adjacent pages
      preloadAdjacentPages();
    }

    function clearSearch() {
      document.getElementById('searchInput').value = '';
      searchTerm = '';
      filteredUrls = [];
      currentPage = 0;
      loadCurrentPageVideo();
      createPagination();
    }

    // Preload adjacent pages in background
    async function preloadAdjacentPages() {
      const pagesToPreload = [currentPage - 1, currentPage + 1, currentPage + 2];
      
      for (const page of pagesToPreload) {
        if (page >= 0 && page < getPageBoundaries().length && !preloadedPages.has(page)) {
          try {
            setTimeout(() => preloadPage(page), 2000); // Delay to not affect current loading
          } catch (err) {
            console.warn('Preload failed for page:', page);
          }
        }
      }
    }

    async function preloadPage(pageIndex) {
      if (preloadedPages.has(pageIndex)) return;
      
      try {
        const pages = getPageBoundaries();
        const pageInfo = pages[pageIndex];
        if (!pageInfo) return;
        
        const urls = filteredUrls.length > 0 ? filteredUrls : allUrls;
        const pageUrls = urls.slice(pageInfo.start, pageInfo.end);
        
        for (const url of pageUrls) {
          const cacheKey = `video_${url}`;
          if (!videoCache.has(cacheKey)) {
            await processVideoUrl(url, true); // Silent preload
          }
        }
        
        preloadedPages.add(pageIndex);
        console.log(`Preloaded page ${pageIndex + 1}`);
      } catch (err) {
        console.warn('Preload error:', err);
      }
    }

    function changePage(newPage) {
      const totalPages = getPageBoundaries().length;
      if (newPage >= 0 && newPage < totalPages && newPage !== currentPage && !isLoading) {
        currentPage = newPage;
        loadCurrentPageVideo();
        createPagination();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    async function loadCurrentPageVideo() {
      if (isLoading) return;
      isLoading = true;
      
      const videosEl = document.getElementById('videos');
      const loadingEl = document.getElementById('loading');
      
      loadingEl.style.display = 'block';
      videosEl.style.display = 'none';
      videosEl.innerHTML = '';
      
      const urls = filteredUrls.length > 0 ? filteredUrls : allUrls;
      const pages = getPageBoundaries();
      const currentPageInfo = pages[currentPage];
      
      if (!currentPageInfo) {
        isLoading = false;
        return;
      }
      
      const pageUrls = urls.slice(currentPageInfo.start, currentPageInfo.end);
      const totalVideos = pageUrls.length;
      
      updateStatus(`Loading ${totalVideos} video${totalVideos !== 1 ? 's' : ''} on page ${currentPage + 1}...`);
      updateProgress(0, 'Preparing videos...');
      
      try {
        // Load videos for current page
        if (totalVideos === 1) {
          // Single video layout (first page)
          await loadSingleVideo(pageUrls[0], 0);
        } else {
          // Grid layout (subsequent pages)
          await loadVideoGrid(pageUrls);
        }
        
        setTimeout(() => {
          loadingEl.style.display = 'none';
          videosEl.style.display = 'block';
          
          // Animate video containers
          const containers = videosEl.querySelectorAll('.video-container, .video-card');
          containers.forEach((container, index) => {
            container.style.opacity = '0';
            container.style.transform = 'translateY(50px)';
            setTimeout(() => {
              container.style.transition = 'all 0.6s ease';
              container.style.opacity = '1';
              container.style.transform = 'translateY(0)';
            }, 100 + index * 100);
          });
        }, 1000);
        
      } catch (err) {
        console.warn('Failed to load page:', err.message);
        addErrorCard(`❌ Failed to load page: ${err.message}`);
        
        setTimeout(() => {
          loadingEl.style.display = 'none';
          videosEl.style.display = 'block';
        }, 1000);
      } finally {
        isLoading = false;
        loadedPages.add(currentPage);
      }
    }

    async function loadSingleVideo(url, index) {
      const cacheKey = `video_${url}`;
      
      updateProgress(50, 'Processing video...');
      
      if (videoCache.has(cacheKey)) {
        console.log('Loading from cache:', url);
        const cachedData = videoCache.get(cacheKey);
        displayCachedVideo(cachedData);
        updateProgress(100, 'Video loaded from cache');
      } else {
        await processVideoUrl(url, false, index);
        updateProgress(100, 'Video loaded');
      }
    }

    async function loadVideoGrid(urls) {
      const videosEl = document.getElementById('videos');
      const gridContainer = document.createElement('div');
      gridContainer.className = 'video-grid';
      
      updateProgress(10, 'Setting up grid...');
      
      let loadedCount = 0;
      const promises = urls.map(async (url, index) => {
        try {
          const cacheKey = `video_${url}`;
          let videoData;
          
          if (videoCache.has(cacheKey)) {
            videoData = videoCache.get(cacheKey);
          } else {
            videoData = await processVideoUrl(url, false, index, true);
            if (videoData) {
              videoCache.set(cacheKey, videoData);
            }
          }
          
          if (videoData) {
            const cardElement = createVideoCard(videoData, index);
            gridContainer.appendChild(cardElement);
          }
          
        } catch (err) {
          console.warn('Failed to load video:', url, err);
          const errorCard = createErrorCard(url, err.message);
          gridContainer.appendChild(errorCard);
        }
        
        loadedCount++;
        updateProgress(10 + (loadedCount / urls.length) * 80, `Loaded ${loadedCount}/${urls.length} videos`);
      });
      
      await Promise.allSettled(promises);
      videosEl.appendChild(gridContainer);
      
      updateProgress(100, 'All videos loaded');
    }

    function displayCachedVideo(cachedData) {
      const container = document.getElementById('videos');
      container.innerHTML = cachedData.html;
    }

    // Enhanced video processing with thumbnail extraction and metadata
    async function processVideoUrl(pageUrl, isPreload = false, index = 0, returnData = false) {
      const domain = new URL(pageUrl).hostname;
      const cacheKey = `video_${pageUrl}`;
      
      if (!isPreload) {
        updateStatus(`Extracting video from ${domain}...`);
      }
      
      // Extract metadata first
      const metadata = await extractVideoMetadata(pageUrl);
      
      const proxyServices = [
        {name: 'AllOrigins', url: `https://api.allorigins.win/get?url=${encodeURIComponent(pageUrl)}`, type: 'json'},
        {name: 'CORS Proxy', url: `https://corsproxy.io/?${encodeURIComponent(pageUrl)}`, type: 'text'},
        {name: 'Proxy.CORS.sh', url: `https://proxy.cors.sh/${pageUrl}`, type: 'text'}
      ];

      for (const proxy of proxyServices) {
        try {
          if (!isPreload) {
            updateStatus(`Loading via ${proxy.name}...`);
          }
          
          const response = await fetch(proxy.url);
          if (!response.ok) continue;
          
          let html;
          if (proxy.type === 'json') {
            const data = await response.json();
            html = data.contents;
          } else {
            html = await response.text();
          }
          
          const videoUrl = extractVideoFromHtml(html, pageUrl);
          const thumbnail = extractThumbnailFromHtml(html, pageUrl);
          
          if (videoUrl) {
            const videoData = {
              pageUrl,
              videoUrl,
              thumbnail,
              metadata,
              type: 'direct',
              status: `✅ ${proxy.name} success`,
              domain,
              html: generateVideoHTML(pageUrl, videoUrl, 'direct', `✅ ${proxy.name} success`, thumbnail, metadata)
            };
            
            videoCache.set(cacheKey, videoData);
            
            if (!isPreload && !returnData) {
              addVideoCard(pageUrl, videoUrl, 'direct', `✅ ${proxy.name} success`, thumbnail, metadata);
            }
            
            return videoData;
          }
        } catch (err) {
          console.warn(`${proxy.name} failed:`, err);
        }
      }

      const specialPlatformData = await trySpecialPlatforms(pageUrl, isPreload, returnData);
      if (specialPlatformData) {
        return specialPlatformData;
      }

      if (!isPreload && !returnData) {
        return await tryAdvancedEmbedding(pageUrl);
      }
      
      return null;
    }

    // Extract video metadata (title, description, etc.)
    async function extractVideoMetadata(pageUrl) {
      try {
        const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(pageUrl)}`);
        if (!response.ok) return {};
        
        const data = await response.json();
        const html = data.contents;
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        const title = doc.querySelector('title')?.textContent || 
                     doc.querySelector('meta[property="og:title"]')?.content || 
                     doc.querySelector('meta[name="twitter:title"]')?.content || 
                     new URL(pageUrl).hostname;
        
        const description = doc.querySelector('meta[property="og:description"]')?.content || 
                           doc.querySelector('meta[name="description"]')?.content || 
                           doc.querySelector('meta[name="twitter:description"]')?.content || '';
        
        return { title: title.substring(0, 100), description: description.substring(0, 200) };
      } catch (err) {
        return { title: new URL(pageUrl).hostname, description: '' };
      }
    }

    // Extract thumbnail from HTML
    function extractThumbnailFromHtml(html, baseUrl) {
      const thumbnailRegexes = [
        /<meta[^>]+property=["']og:image["'][^>]+content=["']([^"'>]+)["']/gi,
        /<meta[^>]+name=["']twitter:image["'][^>]+content=["']([^"'>]+)["']/gi,
        /<meta[^>]+property=["']og:video:thumbnail["'][^>]+content=["']([^"'>]+)["']/gi,
        /<video[^>]+poster=["']([^"'>]+)["']/gi,
        /"thumbnail":\s*"([^"]+)"/gi,
        /"poster":\s*"([^"]+)"/gi
      ];

      for (const regex of thumbnailRegexes) {
        const match = regex.exec(html);
        if (match && match[1]) {
          let thumbnailUrl = match[1];
          
          if (!thumbnailUrl.startsWith('http')) {
            try {
              thumbnailUrl = new URL(thumbnailUrl, baseUrl).href;
            } catch (e) {
              continue;
            }
          }
          
          return thumbnailUrl;
        }
      }
      
      return null;
    }

    function extractVideoFromHtml(html, baseUrl) {
      const extractors = [
        /<video[^>]*src=["']([^"'>]+)["']/gi,
        /<source[^>]*src=["']([^"'>]+)["']/gi,
        /<meta[^>]+property=["']og:video:url["'][^>]+content=["']([^"'>]+)["']/gi,
        /<meta[^>]+property=["']og:video["'][^>]+content=["']([^"'>]+)["']/gi,
        /<meta[^>]+name=["']twitter:player["'][^>]+content=["']([^"'>]+)["']/gi,
        /(?:videoUrl|video_url|mediaUrl|streamUrl|src)\s*[=:]\s*["']([^"'>]+\.(?:mp4|webm|ogg|m3u8)[^"'>]*)["']/gi,
        /"(?:mp4|webm|ogg)":\s*"([^"]+)"/gi,
        /https?:\/\/[^\s"'<>()]+\.(?:mp4|webm|ogg|m3u8)(?:\?[^\s"'<>()]*)?/gi,
        /https?:\/\/[^\s"'<>()]*(?:stream|video|media)[^\s"'<>()]*\.(?:mp4|webm|m3u8)/gi
      ];

      for (const regex of extractors) {
        let match;
        while ((match = regex.exec(html)) !== null) {
          let videoUrl = match[1] || match[0];
          
          if (videoUrl.includes('thumbnail') || videoUrl.includes('preview') || 
              videoUrl.includes('poster') || videoUrl.includes('logo')) {
            continue;
          }
          
          if (videoUrl && !videoUrl.startsWith('http')) {
            try {
              videoUrl = new URL(videoUrl, baseUrl).href;
            } catch (e) {
              continue;
            }
          }
          
          if (videoUrl && videoUrl.startsWith('http')) {
            return videoUrl;
          }
        }
      }
      
      return null;
    }

    async function trySpecialPlatforms(pageUrl, isPreload = false, returnData = false) {
      const url = new URL(pageUrl);
      const domain = url.hostname;
      
      if (url.hostname.includes('youtube.com') || url.hostname.includes('youtu.be')) {
        const videoId = extractYouTubeId(pageUrl);
        if (videoId) {
          const thumbnail = `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`;
          const embedUrl = `https://www.youtube.com/embed/${videoId}`;
          
          const videoData = {
            pageUrl,
            videoUrl: embedUrl,
            thumbnail,
            type: 'embed',
            status: '✅ YouTube Embed',
            domain,
            metadata: { title: 'YouTube Video', description: '' }
          };
          
          videoCache.set(`video_${pageUrl}`, videoData);
          
          if (!isPreload && !returnData) {
            addVideoCard(pageUrl, embedUrl, 'embed', '✅ YouTube Embed', thumbnail);
          }
          
          return returnData ? videoData : true;
        }
      }
      
      if (url.hostname.includes('vimeo.com')) {
        const videoId = pageUrl.match(/vimeo\.com\/(\d+)/);
        if (videoId) {
          const embedUrl = `https://player.vimeo.com/video/${videoId[1]}`;
          
          const videoData = {
            pageUrl,
            videoUrl: embedUrl,
            thumbnail: null,
            type: 'embed',
            status: '✅ Vimeo Embed',
            domain,
            metadata: { title: 'Vimeo Video', description: '' }
          };
          
          videoCache.set(`video_${pageUrl}`, videoData);
          
          if (!isPreload && !returnData) {
            addVideoCard(pageUrl, embedUrl, 'embed', '✅ Vimeo Embed');
          }
          
          return returnData ? videoData : true;
        }
      }
      
      if (url.hostname.includes('dailymotion.com')) {
        const videoId = pageUrl.match(/dailymotion\.com\/video\/([^?&]+)/);
        if (videoId) {
          const embedUrl = `https://www.dailymotion.com/embed/video/${videoId[1]}`;
          
          const videoData = {
            pageUrl,
            videoUrl: embedUrl,
            thumbnail: null,
            type: 'embed',
            status: '✅ Dailymotion Embed',
            domain,
            metadata: { title: 'Dailymotion Video', description: '' }
          };
          
          videoCache.set(`video_${pageUrl}`, videoData);
          
          if (!isPreload && !returnData) {
            addVideoCard(pageUrl, embedUrl, 'embed', '✅ Dailymotion Embed');
          }
          
          return returnData ? videoData : true;
        }
      }
      
      return returnData ? null : false;
    }

    async function tryAdvancedEmbedding(pageUrl) {
      addVideoCard(pageUrl, pageUrl, 'iframe-direct', `⚠️ Direct Embed Attempt`);
    }

    function extractYouTubeId(url) {
      const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
      const match = url.match(regex);
      return match ? match[1] : null;
    }

    // Create video card for grid layout
    function createVideoCard(videoData, index) {
      const card = document.createElement('div');
      card.className = 'video-card';
      card.style.animationDelay = `${index * 0.1}s`;
      
      const domain = videoData.domain || new URL(videoData.pageUrl).hostname;
      const title = videoData.metadata?.title || domain;
      
      card.innerHTML = `
        <div class="video-card-header">
          <div class="video-card-title">${title}</div>
          <div class="video-card-domain">${domain}</div>
        </div>
        <div class="video-container" style="margin: 0;">
          <div class="video-inner">
            <div class="video-face video-front" style="position: relative;">
              ${videoData.thumbnail ? `
                <img src="${videoData.thumbnail}" class="video-thumbnail" 
                     onerror="this.style.display='none'">
                <div class="video-thumbnail-overlay">
                  <div class="play-button">▶</div>
                  <div style="margin-top: 1rem; font-size: 0.8rem; text-align: center; color: white;">
                    ${videoData.status || 'Click to Play'}
                  </div>
                </div>
              ` : `
                <span class="video-icon">🎥</span>
                <span>Click to Play</span>
                <div style="font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.8;">${videoData.status || ''}</div>
              `}
            </div>
            <div class="video-face video-back">
              ${generateVideoBackContent(videoData)}
            </div>
          </div>
        </div>
      `;
      
      return card;
    }

    function generateVideoBackContent(videoData) {
      if (videoData.type === 'direct') {
        return `
          <video controls preload="metadata" crossorigin="anonymous" controlsList="nodownload">
            <source src="${videoData.videoUrl}" type="video/mp4">
            Your browser does not support the video tag.
          </video>`;
      } else if (videoData.type === 'embed') {
        return `<iframe src="${videoData.videoUrl}" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
      } else if (videoData.type === 'iframe-direct') {
        return `
          <iframe src="${videoData.pageUrl}" frameborder="0" allowfullscreen 
                  sandbox="allow-scripts allow-same-origin allow-forms allow-popups"
                  referrerpolicy="no-referrer"
                  style="background: #000;"></iframe>`;
      }
      return '';
    }

    function createErrorCard(url, errorMessage) {
      const card = document.createElement('div');
      card.className = 'video-card';
      
      const domain = new URL(url).hostname;
      
      card.innerHTML = `
        <div class="video-card-header">
          <div class="video-card-title">❌ Failed to Load</div>
          <div class="video-card-domain">${domain}</div>
        </div>
        <div style="padding: 2rem; text-align: center;">
          <div class="error-card" style="margin: 0;">
            ${errorMessage}
          </div>
        </div>
      `;
      
      return card;
    }

    function addVideoCard(pageUrl, videoUrl, type, status, thumbnail = null, metadata = null) {
      const container = document.getElementById('videos');
      const videoHTML = generateVideoHTML(pageUrl, videoUrl, type, status, thumbnail, metadata);
      container.innerHTML = videoHTML;

      const video = container.querySelector('video');
      if (video) {
        video.addEventListener('error', () => {
          console.warn('Video failed to load:', videoUrl);
          container.querySelector('.video-back').innerHTML = `
            <div class="error-card">❌ Video failed to load</div>`;
        });
      }
    }

    function generateVideoHTML(pageUrl, videoUrl, type, status, thumbnail = null, metadata = null) {
      const domain = new URL(pageUrl).hostname;
      const title = metadata?.title || domain;
      
      let backContent = '';
      
      if (type === 'direct') {
        backContent = `
          <video controls preload="metadata" crossorigin="anonymous" controlsList="nodownload">
            <source src="${videoUrl}" type="video/mp4">
            Your browser does not support the video tag.
          </video>`;
      } else if (type === 'embed') {
        backContent = `<iframe src="${videoUrl}" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
      } else if (type === 'iframe-direct') {
        backContent = `
          <iframe src="${pageUrl}" frameborder="0" allowfullscreen 
                  sandbox="allow-scripts allow-same-origin allow-forms allow-popups"
                  referrerpolicy="no-referrer"
                  style="background: #000;"></iframe>`;
      }

      return `
        <div class="video-container">
          <div class="video-inner">
            <div class="video-face video-front" style="position: relative;">
              ${thumbnail ? `
                <img src="${thumbnail}" class="video-thumbnail" 
                     onerror="this.style.display='none'" alt="${title}">
                <div class="video-thumbnail-overlay">
                  <div class="play-button">▶</div>
                  <div style="margin-top: 1rem; font-size: 1rem; text-align: center; color: white; font-weight: 600;">
                    ${title.length > 50 ? title.substring(0, 50) + '...' : title}
                  </div>
                  <div style="font-size: 0.8rem; margin-top: 0.5rem; color: rgba(255,255,255,0.8);">
                    ${status || 'Click to Play'}
                  </div>
                  <div style="font-size: 0.7rem; margin-top: 0.3rem; color: rgba(255,255,255,0.6);">
                    ${domain}
                  </div>
                </div>
              ` : `
                <span class="video-icon">🎥</span>
                <span style="font-size: 1.2rem; margin-bottom: 0.5rem; display: block;">
                  ${title.length > 40 ? title.substring(0, 40) + '...' : title}
                </span>
                <span>Click to Play</span>
                <div style="font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.8;">${status || ''}</div>
                <div style="font-size: 0.7rem; margin-top: 0.5rem; opacity: 0.6;">${domain}</div>
              `}
            </div>
            <div class="video-face video-back">
              ${backContent}
            </div>
          </div>
        </div>
      `;
    }

    function addErrorCard(message) {
      const container = document.getElementById('videos');
      const card = document.createElement('div');
      card.innerHTML = `<div class="error-card">${message}</div>`;
      container.appendChild(card);
    }

    // Background caching system
    async function startBackgroundCaching() {
      if (isBackgroundLoading) return;
      
      isBackgroundLoading = true;
      backgroundLoadProgress = 0;
      
      const backgroundStatus = document.getElementById('backgroundStatus');
      const totalVideos = document.getElementById('totalVideos');
      const backgroundProgress = document.getElementById('backgroundProgress');
      
      backgroundStatus.style.display = 'block';
      totalVideos.textContent = allUrls.length;
      backgroundProgress.textContent = '0';
      
      createPagination(); // Update pagination to show caching button as disabled
      
      for (let i = 0; i < allUrls.length; i++) {
        if (!isBackgroundLoading) break; // Allow stopping
        
        try {
          const url = allUrls[i];
          const cacheKey = `video_${url}`;
          
          if (!videoCache.has(cacheKey)) {
            await processVideoUrl(url, true); // Silent background load
            await new Promise(resolve => setTimeout(resolve, 500)); // Rate limiting
          }
          
          backgroundLoadProgress++;
          backgroundProgress.textContent = backgroundLoadProgress;
          
        } catch (err) {
          console.warn('Background caching error:', err);
        }
      }
      
      isBackgroundLoading = false;
      backgroundStatus.innerHTML = `
        <div style="font-size: 0.9rem; color: rgba(0,255,0,0.9);">
          ✅ Background caching completed! All ${backgroundLoadProgress} videos cached.
        </div>
      `;
      
      setTimeout(() => {
        backgroundStatus.style.display = 'none';
      }, 5000);
      
      createPagination(); // Update pagination
    }

    function updateBackgroundStatus() {
      const backgroundProgress = document.getElementById('backgroundProgress');
      const totalVideos = document.getElementById('totalVideos');
      
      if (backgroundProgress && totalVideos) {
        backgroundProgress.textContent = backgroundLoadProgress;
        totalVideos.textContent = allUrls.length;
      }
    }

    // Fullscreen TikTok-style functionality
    function enterFullscreen() {
      const fullscreenContainer = document.getElementById('fullscreenContainer');
      const fullscreenContent = document.getElementById('fullscreenContent');
      const currentVideo = document.querySelector('#videos .video-back video, #videos .video-back iframe');
      
      if (currentVideo) {
        const clonedVideo = currentVideo.cloneNode(true);
        clonedVideo.className = 'fullscreen-video';
        clonedVideo.controls = true;
        
        fullscreenContent.innerHTML = '';
        fullscreenContent.appendChild(clonedVideo);
        fullscreenContainer.style.display = 'block';
        
        // Add swipe/scroll functionality
        let touchStartY = 0;
        let isScrolling = false;
        
        fullscreenContainer.addEventListener('touchstart', (e) => {
          touchStartY = e.touches[0].clientY;
        });
        
        fullscreenContainer.addEventListener('touchmove', (e) => {
          if (isScrolling) return;
          
          const touchY = e.touches[0].clientY;
          const diff = touchStartY - touchY;
          
          if (Math.abs(diff) > 50) {
            isScrolling = true;
            if (diff > 0) {
              nextVideo();
            } else {
              previousVideo();
            }
            setTimeout(() => { isScrolling = false; }, 500);
          }
        });
        
        // Keyboard navigation
        document.addEventListener('keydown', handleFullscreenKeys);
      }
    }

    function exitFullscreen() {
      const fullscreenContainer = document.getElementById('fullscreenContainer');
      fullscreenContainer.style.display = 'none';
      document.removeEventListener('keydown', handleFullscreenKeys);
    }

    function handleFullscreenKeys(e) {
      switch(e.key) {
        case 'ArrowUp':
          e.preventDefault();
          previousVideo();
          break;
        case 'ArrowDown':
          e.preventDefault();
          nextVideo();
          break;
        case 'Escape':
          exitFullscreen();
          break;
        case ' ':
          e.preventDefault();
          randomVideo();
          break;
      }
    }

    function nextVideo() {
      const totalPages = getPageBoundaries().length;
      if (currentPage < totalPages - 1) {
        changePage(currentPage + 1);
        setTimeout(updateFullscreenVideo, 1000);
      }
    }

    function previousVideo() {
      if (currentPage > 0) {
        changePage(currentPage - 1);
        setTimeout(updateFullscreenVideo, 1000);
      }
    }

    function randomVideo() {
      const totalPages = getPageBoundaries().length;
      const randomPage = Math.floor(Math.random() * totalPages);
      changePage(randomPage);
      setTimeout(updateFullscreenVideo, 1000);
    }

    function updateFullscreenVideo() {
      const fullscreenContainer = document.getElementById('fullscreenContainer');
      if (fullscreenContainer.style.display === 'block') {
        const currentVideo = document.querySelector('#videos .video-back video, #videos .video-back iframe');
        if (currentVideo) {
          const fullscreenContent = document.getElementById('fullscreenContent');
          const clonedVideo = currentVideo.cloneNode(true);
          clonedVideo.className = 'fullscreen-video';
          clonedVideo.controls = true;
          
          fullscreenContent.innerHTML = '';
          fullscreenContent.appendChild(clonedVideo);
        }
      }
    }

    // Enhanced Products Loading with Pagination
    async function loadProductsFromJSON() {
      try {
        const response = await fetch('https://raw.githubusercontent.com/MustakimRidoyMR/MustakimRidoyMR.github.io/main/MR%20Database/affiliate.json');
        
        if (!response.ok) {
          throw new Error('ডেটা লোড করতে সমস্যা হয়েছে');
        }

        productsData = await response.json();
        displayProductPage(0);
        createProductPagination();
        
      } catch (error) {
        console.error('ডেটা লোড করতে সমস্যা:', error);
        loadFallbackProducts();
      }
    }

    function loadFallbackProducts() {
      productsData = [
        {
          "title": "Product: Hand Grip 5-60Kg Adjustable Hand Strengthener Grip Trainer - Hand Grip - Lifestyle",
          "text": "I found this great deal on Daraz! Check it out! \nProduct Price: ৳550\nDiscount Price: ৳145",
          "button": "Buy Now",
          "url": "https://s.daraz.com.bd/s.ZSqA5?cc",
          "image": "https://static-01.daraz.com.bd/p/7b621f977a71e0423fce9296b1987fb4.jpg"
        },
        {
          "title": "New Feature",
          "text": "Check to click here",
          "button": "Buy Now",
          "url": "https://amzn.to/3NOG3er",
          "image": "https://raw.githubusercontent.com/MustakimRidoyMR/MustakimRidoyMR.github.io/main/Images/Apk%20Cover%20Photo.jpeg"
        },
        {
          "title": "Update version 1",
          "text": "Check it now",
          "button": "Buy Now",
          "url": "https://amzn.to/3NOG3er",
          "image": "https://t3.ftcdn.net/jpg/02/93/37/28/360_F_293372811_2gpgNsJ3TQSPsfAbmBPIYfuKfAw70bpt.jpg"
        },
        {
          "title": "Use AI",
          "text": "Use AI for your work",
          "button": "Try Now",
          "url": "https://mustakimridoymr.github.io",
          "image": "https://incubator.ucf.edu/wp-content/uploads/2023/07/artificial-intelligence-new-technology-science-futuristic-abstract-human-brain-ai-technology-cpu-central-processor-unit-c[...]"
        }
      ];
      
      displayProductPage(0);
      createProductPagination();
    }

    function displayProductPage(pageIndex) {
      const grid = document.getElementById('products-grid');
      const startIndex = pageIndex * productsPerPage;
      const endIndex = startIndex + productsPerPage;
      const pageProducts = productsData.slice(startIndex, endIndex);
      
      grid.innerHTML = '';
      
      pageProducts.forEach((product, index) => {
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.style.animationDelay = `${index * 0.1}s`;
        
        const isSpecialOffer = product.text && product.text.includes('৳');
        
        productCard.innerHTML = `
          ${isSpecialOffer ? '<div class="product-badge">Special Offer!</div>' : ''}
          <img src="${product.image}" alt="${product.title}" class="product-image"
               onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjQwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiNmMGYwZjAiLz48dGV4dCB4PSIyMDAiIHk9IjEwMCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE2IiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+SW1hZ2UgTm90IEZvdW5kPC90ZXh0Pjwvc3ZnPg=='">
          <h4 class="product-title">${product.title}</h4>
          <p class="product-text">${product.text || ''}</p>
          <a href="${product.url}" target="_blank" rel="noopener noreferrer" class="product-button">
            ${product.button && product.button.includes('Try') ? '🚀' : '🛒'} ${product.button || 'Buy Now'}
          </a>
        `;
        
        grid.appendChild(productCard);
      });
      
      currentProductPage = pageIndex;
    }

    function createProductPagination() {
      const totalPages = Math.ceil(productsData.length / productsPerPage);
      if (totalPages <= 1) return;
      
      const paginationEl = document.getElementById('productPagination');
      paginationEl.innerHTML = '';
      
      for (let i = 0; i < totalPages; i++) {
        const button = document.createElement('button');
        button.className = `product-page-btn ${i === currentProductPage ? 'active' : ''}`;
        button.textContent = i + 1;
        button.onclick = () => displayProductPage(i);
        paginationEl.appendChild(button);
      }
      
      paginationEl.style.display = 'flex';
    }

    // Main initialization
    (async function() {
      createParticles();
      
      const rawListURL = 'https://raw.githubusercontent.com/application0/MyData/refs/heads/main/FindVideoInURLs';
      const loadingEl = document.getElementById('loading');
      
      try {
        updateStatus('Downloading URL list...');
        updateProgress(10, 'Connecting to server...');
        
        const res = await fetch(rawListURL);
        if (!res.ok) throw new Error('Failed to load video list');
        
        updateProgress(30, 'Processing video URLs...');
        
        const text = await res.text();
        allUrls = text.split(/\r?\n/).filter(u => u.trim() && /^https?:\/\//.test(u.trim()));
        
        if (allUrls.length === 0) {
          throw new Error('No valid URLs found');
        }

        updateStatus(`Found ${allUrls.length} videos. Loading first video...`);
        updateProgress(80, 'Setting up interface...');
        
        // Initialize with first page
        await loadCurrentPageVideo();
        createPagination();
        
        updateProgress(100, 'Ready!');

        // Load products in background
        setTimeout(loadProductsFromJSON, 1500);
        
        // Start background caching after initial load
        setTimeout(() => {
          if (!isBackgroundLoading) {
            console.log('Background caching available. Click "Cache All" to start.');
          }
        }, 3000);

      } catch (err) {
        loadingEl.innerHTML = `<div class="error-card">⚠️ ${err.message}</div>`;
        return;
      }
    })();
  </script>

  <!-- Social Bar Ad - Before closing body tag -->
  <script type='text/javascript' src='//pl27022518.profitableratecpm.com/c9/4a/0b/c94a0b4ed40971010199e9dd59a95e25.js'></script>
</body>
</html>
